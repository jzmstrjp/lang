# ãƒ‘ã‚¿ãƒ¼ãƒ³å­¦ç¿’ãƒ¢ãƒ¼ãƒ‰ è©³ç´°å®Ÿè£…ã‚¬ã‚¤ãƒ‰

## ã‚³ãƒ³ã‚»ãƒ—ãƒˆ

**ãªãœæ—¥æœ¬äººã¯ä¸­é«˜6å¹´ã‚‚è‹±èªã‚’å‹‰å¼·ã—ãŸã®ã«è‹±èªã‚’è©±ã›ãªã„ã®ï¼Ÿ**

å­ä¾›ã¯å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã®å·®åˆ†ã‹ã‚‰è¨€èªã‚’ç†è§£ã—ã¾ã™ï¼š

```
ã€ŒCan you pass me the salt?ã€â†’ã€Œã¯ã„ã€ãŠå¡©ã©ã†ãã€
ã€ŒCan you pass me the remote?ã€â†’ã€Œã¯ã„ã€ãƒªãƒ¢ã‚³ãƒ³ã©ã†ãã€
ã€ŒCan you pass me the pen?ã€â†’ã€Œã¯ã„ã€ãƒšãƒ³ã©ã†ãã€
```

ã“ã‚Œã‚’è¦‹ã¦äººé–“ã®è„³ã¯è‡ªå‹•çš„ã«ã€ŒPass me the ã€‡ã€‡ã€‡.ã€ãŒã€Œã€‡ã€‡ã€‡ã‚’ã¨ã£ã¦ã‚‚ã‚‰ãˆã‚‹ï¼Ÿã€ã¨ã„ã†æ„å‘³ã ã¨ç†è§£ã—ã¾ã™ã€‚

ã“ã®Webã‚¢ãƒ—ãƒªã§ã¯ã€ã“ã®è‡ªç„¶ãªå­¦ç¿’ãƒ—ãƒ­ã‚»ã‚¹ã‚’å†ç¾ã—ã¾ã™ã€‚

## ç›®æ¬¡

1. [ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼](#ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼)
2. [å­¦ç¿’ãƒ•ãƒ­ãƒ¼è¨­è¨ˆ](#å­¦ç¿’ãƒ•ãƒ­ãƒ¼è¨­è¨ˆ)
3. [ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆ](#ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆ)
4. [éŸ³å£°ç”Ÿæˆã®å®Ÿè£…](#éŸ³å£°ç”Ÿæˆã®å®Ÿè£…)
5. [ç”»åƒç”Ÿæˆã®å®Ÿè£…](#ç”»åƒç”Ÿæˆã®å®Ÿè£…)
6. [å®Ÿè£…ã‚³ãƒ¼ãƒ‰ä¾‹](#å®Ÿè£…ã‚³ãƒ¼ãƒ‰ä¾‹)
7. [ã‚·ãƒ¼ãƒ‰ç”Ÿæˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ](#ã‚·ãƒ¼ãƒ‰ç”Ÿæˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ)

---

## ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼

### ä½“é¨“ã®æµã‚Œ

ãƒ¦ãƒ¼ã‚¶ãƒ¼ã€ŒãŠã€ãƒ‘ã‚¿ãƒ¼ãƒ³å­¦ç¿’ãƒ¢ãƒ¼ãƒ‰ã£ã¦ã®ãŒã‚ã‚‹ãªã€

#### ä¾‹æ–‡1

é£Ÿå“ã«ã„ã‚‹å¥³æ€§ã®ç”»åƒ  
éŸ³å£°ï¼šã€ŒCan you pass me the salt?ã€

é£Ÿå“ã«ã„ã‚‹ç”·æ€§ã®ç”»åƒ  
éŸ³å£°ï¼šã€Œã¯ã„ã€ãŠå¡©ã©ã†ãã€

ãƒ¦ãƒ¼ã‚¶ãƒ¼ã€Œãµãƒ¼ã‚“ã€ã€Can you pass me the salt?ã€ã§ã€ãŠå¡©ã©ã†ãã€ã£ã¦è¿”ã£ã¦ã‚‹ã®ã‹ã€

ç”»é¢ï¼šã€Œæ¬¡ã®ä¾‹ã¸ã€ãƒœã‚¿ãƒ³  
ãƒ¦ãƒ¼ã‚¶ãƒ¼ã€Œãƒãƒãƒƒã€

#### ä¾‹æ–‡2

ãƒªãƒ“ãƒ³ã‚°ã«ã„ã‚‹ç”·æ€§ã®ç”»åƒ  
éŸ³å£°ï¼šã€ŒCan you pass me the remote?ã€

ãƒªãƒ“ãƒ³ã‚°ã«ã„ã‚‹å¥³æ€§ã®ç”»åƒ  
éŸ³å£°ï¼šã€Œã¯ã„ã€ãƒªãƒ¢ã‚³ãƒ³ã©ã†ãã€

ãƒ¦ãƒ¼ã‚¶ãƒ¼ã€Œã‚ã‚Œï¼Ÿä»Šåº¦ã¯ã€remoteã€ã ã€‚ã§ã‚‚è¿”ç­”ã¯åŒã˜ã‚ˆã†ã«ã€ã©ã†ãã€ã£ã¦æ¸¡ã—ã¦ã‚‹ãªã€

ç”»é¢ï¼šã€Œæ¬¡ã®ä¾‹ã¸ã€ãƒœã‚¿ãƒ³  
ãƒ¦ãƒ¼ã‚¶ãƒ¼ã€Œãƒãƒãƒƒã€

#### ä¾‹æ–‡3

ã‚ªãƒ•ã‚£ã‚¹ã«ã„ã‚‹å¥³æ€§ã®ç”»åƒ  
éŸ³å£°ï¼šã€ŒCan you pass me the pen?ã€

ã‚ªãƒ•ã‚£ã‚¹ã«ã„ã‚‹ç”·æ€§ã®ç”»åƒ  
éŸ³å£°ï¼šã€Œã„ã„ã‚ˆã€ã©ã‚Œï¼Ÿã€

ãƒ¦ãƒ¼ã‚¶ãƒ¼ã€ŒãŠã£ã€ä»Šåº¦ã¯ã€penã€ã ã€  
ãƒ¦ãƒ¼ã‚¶ãƒ¼ã€Œsaltã€remoteã€pen...ã‚ã€ã“ã“ãŒå¤‰ã‚ã£ã¦ã‚‹ã‚“ã ï¼ã€  
ãƒ¦ãƒ¼ã‚¶ãƒ¼ã€Œã€Can you pass me the ã€‡ã€‡ã€‡?ã€ã§ã€ã€‡ã€‡ã€‡ã‚’å–ã£ã¦ã‚‚ã‚‰ã†ã€ã£ã¦æ„å‘³ãªã®ã‹ãªï¼Ÿã€

#### ãƒ†ã‚¹ãƒˆå•é¡Œ

ç”»é¢ï¼šå¤§ããè¡¨ç¤ºã•ã‚Œã‚‹

```
ã€ŒCan you pass me the ã€‡ã€‡ã€‡?ã€
ã®æ„å‘³ã¯ã©ã‚Œã§ã—ã‚‡ã†ï¼Ÿ
```

ç”»é¢ï¼š4æŠè¡¨ç¤º

- ã€‡ã€‡ã€‡ã‚’å–ã£ã¦ãã‚Œã¾ã›ã‚“ã‹ï¼Ÿ â†
- ã€‡ã€‡ã€‡ã‚’è²·ã„ã«è¡Œãã¾ã—ã‚‡ã†
- ã€‡ã€‡ã€‡ãŒå¥½ãã§ã™
- ã€‡ã€‡ã€‡ã¯ã©ã“ã§ã™ã‹ï¼Ÿ

ãƒ¦ãƒ¼ã‚¶ãƒ¼ã€ŒãŠã£ã€ã€‡ã€‡ã€‡ã£ã¦æ›¸ã„ã¦ã‚ã‚‹ï¼ã€  
ãƒ¦ãƒ¼ã‚¶ãƒ¼ã€Œç‰¹å®šã®å˜èªã˜ã‚ƒãªãã¦ã€æ§‹æ–‡å…¨ä½“ã®æ„å‘³ã‚’èã‹ã‚Œã¦ã‚‹ã‚“ã ãªã€  
ãƒ¦ãƒ¼ã‚¶ãƒ¼ã€Œã•ã£ãå­¦ã‚“ã ãƒ‘ã‚¿ãƒ¼ãƒ³ã ã¨...ã€ã€‡ã€‡ã€‡ã‚’å–ã£ã¦ãã‚Œã¾ã›ã‚“ã‹ï¼Ÿã€ã ãªã€‚ãƒãƒãƒƒã€

#### çµæœ

ç”»é¢ï¼šã€Œæ­£è§£ã§ã™ï¼ğŸ‰ã€  
ç”»é¢ï¼šã€Œãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ç†è§£ã§ãã¦ã„ã¾ã™ã­ï¼ã€

```
âœ“ Can you pass me the [object]? ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ç¿’å¾—
âœ“ æ§‹æ–‡ã®æ„å‘³ã‚’æ­£ã—ãç†è§£ã§ãã¾ã—ãŸ
```

ãƒ¦ãƒ¼ã‚¶ãƒ¼ã€Œã‚„ã£ãŸï¼ã€  
ãƒ¦ãƒ¼ã‚¶ãƒ¼ã€Œã“ã‚Œã€bookã¨ã‹coffeeã¨ã‹ã€ã©ã‚“ãªå˜èªã‚’å…¥ã‚Œã¦ã‚‚ä½¿ãˆã‚‹ã£ã¦ã“ã¨ã‹ã€  
ãƒ¦ãƒ¼ã‚¶ãƒ¼ã€Œã€bookã€ã£ã¦å˜èªã‚’è¨³ã›ãŸã‚“ã˜ã‚ƒãªãã¦ã€ã€ã“ã®ãƒ‘ã‚¿ãƒ¼ãƒ³å…¨ä½“ã€ã®æ„å‘³ãŒåˆ†ã‹ã£ãŸãï¼ã€

ç”»é¢ï¼š

```
ã“ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ä½¿ã£ãŸä¾‹ï¼š
- Can you pass me the book? â†’ æœ¬ã‚’å–ã£ã¦ãã‚Œã¾ã›ã‚“ã‹ï¼Ÿ
- Can you pass me the water? â†’ æ°´ã‚’å–ã£ã¦ãã‚Œã¾ã›ã‚“ã‹ï¼Ÿ
- Can you pass me the phone? â†’ é›»è©±ã‚’å–ã£ã¦ãã‚Œã¾ã›ã‚“ã‹ï¼Ÿ
```

ãƒ¦ãƒ¼ã‚¶ãƒ¼ã€ŒãŠãŠã€ã©ã‚“ãªç‰©ã«ã‚‚ä½¿ãˆã‚‹ã‚“ã ï¼ã€  
ãƒ¦ãƒ¼ã‚¶ãƒ¼ã€Œå˜èªã‚’ä¸€ã¤ä¸€ã¤è¦šãˆã‚‹ã‚“ã˜ã‚ƒãªãã¦ã€æ§‹æ–‡ã‚’ç†è§£ã™ã‚Œã°å¿œç”¨ãŒåŠ¹ãã®ã‹ã€

### ã“ã®ãƒ¢ãƒ¼ãƒ‰ã®å„ªä½æ€§

- **æ§‹æ–‡ç†è§£ã®é”æˆæ„Ÿ**ï¼šå˜èªã®æš—è¨˜ã§ã¯ãªãã€Œæ§‹é€ ã‚’ç†è§£ã§ããŸã€ã¨ã„ã†æœ¬è³ªçš„ãªå­¦ã³ã®å–œã³ãŒã‚ã‚‹
- **å¿œç”¨åŠ›ã®å®Ÿæ„Ÿ**ï¼šã€‡ã€‡ã€‡ã¨ã„ã†å¤‰æ•°ã§æç¤ºã™ã‚‹ã“ã¨ã§ã€ç„¡é™ã®å¿œç”¨ãŒå¯èƒ½ã ã¨ç†è§£ã§ãã‚‹
- **å·®åˆ†å­¦ç¿’**ï¼šè¤‡æ•°ã®ä¾‹ã®ã€Œé•ã„ã€ã«æ³¨ç›®ã™ã‚‹ã“ã¨ã§ã€è¨€èªã®æœ¬è³ªçš„ãªæ§‹é€ ã‚’ç†è§£ã§ãã‚‹
- **è„³ã®è‡ªç„¶ãªãƒ—ãƒ­ã‚»ã‚¹**ï¼šæ˜ç¤ºçš„ã«ã€Œã©ã“ãŒé•ã†ï¼Ÿã€ã¨èã‹ãšã¨ã‚‚ã€äººé–“ã®è„³ãŒè‡ªå‹•çš„ã«å·®åˆ†ã‚’è¦‹ã¤ã‘ã‚‹
- **æŠ½è±¡åŒ–ã•ã‚ŒãŸçŸ¥è­˜**ï¼šã€Œbook = æœ¬ã€ã¨ã„ã†å€‹åˆ¥çŸ¥è­˜ã§ã¯ãªãã€æ§‹æ–‡ã¨ã„ã†æŠ½è±¡çš„ãªçŸ¥è­˜ã‚’ç²å¾—ã§ãã‚‹

---

## å­¦ç¿’ãƒ•ãƒ­ãƒ¼è¨­è¨ˆ

### ã‚·ãƒ³ãƒ—ãƒ«ãª3ã‚¹ãƒ†ãƒƒãƒ—

```
1. ä¾‹æ–‡ã‚’è¦‹ã‚‹ï¼ˆ3ã€œ5å€‹ï¼‰
   â†“
2. ãƒ†ã‚¹ãƒˆå•é¡Œã€Œã€‡ã€‡ã€‡ã€å½¢å¼ã§æ§‹æ–‡ç†è§£ã‚’ç¢ºèª
   â†“
3. æ­£è§£å¾Œã€å¿œç”¨ä¾‹ã‚’è¡¨ç¤º
```

**é‡è¦ï¼šã€Œãƒ‘ã‚¿ãƒ¼ãƒ³ç™ºè¦‹ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã€ã¯ä¸è¦**

- âŒ ã€Œã©ã“ãŒå¤‰ã‚ã£ã¦ã„ã¾ã™ã‹ï¼Ÿã€ã¨æ˜ç¤ºçš„ã«èã
- âŒ ãƒã‚¤ãƒ©ã‚¤ãƒˆè¡¨ç¤ºã§ç­”ãˆã‚’æ•™ãˆã‚‹
- âœ… äººé–“ã®è„³ãŒè‡ªå‹•çš„ã«å·®åˆ†ã‚’è¦‹ã¤ã‘ã‚‹ãƒ—ãƒ­ã‚»ã‚¹ã«ä»»ã›ã‚‹

---

## ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆ

### è¨­è¨ˆæ€æƒ³

**æ—¢å­˜ãƒ†ãƒ¼ãƒ–ãƒ«ã®å†åˆ©ç”¨**ï¼šãƒ‘ã‚¿ãƒ¼ãƒ³å­¦ç¿’ã®ä¾‹æ–‡ã¯ã€é€šå¸¸ã®`Problem`ã¨åŒã˜æ§‹é€ ã‚’æŒã£ã¦ã„ã¾ã™ã€‚æ–°ã—ã„ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œã‚‰ãšã€æ—¢å­˜ã®`Problem`ãƒ†ãƒ¼ãƒ–ãƒ«ã«`patternId`ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ã§ã€ãƒ‡ãƒ¼ã‚¿ã®é‡è¤‡ã‚’é¿ã‘ã¾ã™ã€‚

### ãƒ¡ãƒªãƒƒãƒˆ

1. **ãƒ‡ãƒ¼ã‚¿ã®å†åˆ©ç”¨**: ãƒ‘ã‚¿ãƒ¼ãƒ³å­¦ç¿’ã§ä½¿ã£ãŸå•é¡ŒãŒã€shortãƒ¢ãƒ¼ãƒ‰ãªã©é€šå¸¸ã®å­¦ç¿’ã§ã‚‚å‡ºç¾ã™ã‚‹
2. **å¾©ç¿’åŠ¹æœ**: ã€Œã‚ã€ã“ã‚Œãƒ‘ã‚¿ãƒ¼ãƒ³å­¦ç¿’ã§è¦‹ãŸã‚„ã¤ã ï¼ã€ã¨ã„ã†å®šç€åŠ¹æœ
3. **ãƒ†ãƒ¼ãƒ–ãƒ«å‰Šæ¸›**: `pattern_examples`ãƒ†ãƒ¼ãƒ–ãƒ«ãŒä¸è¦ã«ãªã‚Šã€è¨­è¨ˆãŒã‚·ãƒ³ãƒ—ãƒ«ã«
4. **ã‚¯ã‚¨ãƒªã®çµ±ä¸€**: é€šå¸¸å•é¡Œã¨ãƒ‘ã‚¿ãƒ¼ãƒ³å•é¡Œã‚’åŒã˜APIã§æ‰±ãˆã‚‹

### å¿…è¦ãªãƒ‡ãƒ¼ã‚¿

1. **ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚»ãƒƒãƒˆ**: ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ãƒ¡ã‚¿æƒ…å ±
2. **ä¾‹æ–‡**: `Problem`ãƒ†ãƒ¼ãƒ–ãƒ«ã«`patternId`ã‚’ä»˜ã‘ã¦ä¿å­˜
3. **ãƒ†ã‚¹ãƒˆå•é¡Œ**: ã€Œã€‡ã€‡ã€‡ã€å½¢å¼ã§ã®æ§‹æ–‡ç†è§£ç¢ºèª
4. **å¿œç”¨ä¾‹**: æ­£è§£å¾Œã«è¡¨ç¤ºã™ã‚‹è¿½åŠ ã®å…·ä½“ä¾‹

### Prismaã‚¹ã‚­ãƒ¼ãƒã®å¤‰æ›´

```prisma
// prisma/schema.prisma ã®æ—¢å­˜Problemãƒ¢ãƒ‡ãƒ«ã‚’æ‹¡å¼µ

model Problem {
  id                String     @id @default(cuid())

  // æ—¢å­˜ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
  wordCount         Int
  englishSentence   String
  japaneseSentence  String
  japaneseReply     String
  englishReply      String
  incorrectOptions  Json
  senderVoice       VoiceType
  senderRole        String
  receiverVoice     VoiceType
  receiverRole      String
  place             String

  audioEnUrl        String?
  audioJaUrl        String?
  audioEnReplyUrl   String?
  imageUrl          String?
  audioReady        Boolean    @default(false)

  // âœ¨ æ–°è¦è¿½åŠ : ãƒ‘ã‚¿ãƒ¼ãƒ³å­¦ç¿’ç”¨ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
  patternId         String?                    // ãƒ‘ã‚¿ãƒ¼ãƒ³å­¦ç¿’ã®ä¸€éƒ¨ãªã‚‰è¨­å®š
  patternOrder      Int?                       // ãƒ‘ã‚¿ãƒ¼ãƒ³å†…ã§ã®é †åºï¼ˆ1, 2, 3...ï¼‰
  pattern           PatternSet? @relation(fields: [patternId], references: [id], onDelete: Cascade)

  createdAt         DateTime   @default(now())
  updatedAt         DateTime   @updatedAt

  @@unique([englishSentence])
  @@index([wordCount, audioReady])
  @@index([patternId, patternOrder])  // âœ¨ æ–°è¦ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
  @@map("problems")
}

// æ–°è¦è¿½åŠ : ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚»ãƒƒãƒˆ
model PatternSet {
  id                   String              @id @default(cuid())
  patternName          String              // "Can you pass me the ã€‡ã€‡ã€‡?"ï¼ˆã€‡ã€‡ã€‡å½¢å¼ã§ä¿å­˜ï¼‰
  patternMeaning       String              // "ã€‡ã€‡ã€‡ã‚’å–ã£ã¦ãã‚Œã¾ã›ã‚“ã‹ï¼Ÿ"ï¼ˆã€‡ã€‡ã€‡å½¢å¼ã§ä¿å­˜ï¼‰
  patternDescription   String              // "ç‰©ã‚’å–ã£ã¦ã‚‚ã‚‰ã†ä¾é ¼è¡¨ç¾"
  difficulty           DifficultyLevel     @default(beginner)

  examples             Problem[]           // âœ¨ PatternExampleã§ã¯ãªãProblemï¼
  testProblem          PatternTestProblem?
  additionalExamples   Json?               // æ­£è§£å¾Œã«è¡¨ç¤ºã™ã‚‹å¿œç”¨ä¾‹ï¼ˆé…åˆ—ï¼‰
  relatedPatternIds    String[]            // é–¢é€£ãƒ‘ã‚¿ãƒ¼ãƒ³ã®IDãƒªã‚¹ãƒˆ

  createdAt            DateTime            @default(now())
  updatedAt            DateTime            @updatedAt

  @@index([difficulty])
  @@map("pattern_sets")
}

// PatternExampleãƒ†ãƒ¼ãƒ–ãƒ«ã¯å‰Šé™¤ï¼ä»£ã‚ã‚Šã«Problemã‚’ä½¿ã†

model PatternTestProblem {
  id                String     @id @default(cuid())
  patternSetId      String     @unique
  patternSet        PatternSet @relation(fields: [patternSetId], references: [id], onDelete: Cascade)

  // ãƒ†ã‚¹ãƒˆå•é¡Œï¼ˆã€‡ã€‡ã€‡å½¢å¼ã§å•ã†ï¼‰
  questionPattern   String     // "Can you pass me the ã€‡ã€‡ã€‡?"
  correctAnswer     String     // "ã€‡ã€‡ã€‡ã‚’å–ã£ã¦ãã‚Œã¾ã›ã‚“ã‹ï¼Ÿ"
  incorrectOptions  Json       // ä¸æ­£è§£ã®é¸æŠè‚¢ï¼ˆé…åˆ—ï¼‰

  createdAt         DateTime   @default(now())
  updatedAt         DateTime   @updatedAt

  @@map("pattern_test_problems")
}

enum DifficultyLevel {
  beginner
  intermediate
  advanced
}
```

### ã‚¯ã‚¨ãƒªä¾‹

```typescript
// ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ä¾‹æ–‡ã‚’å–å¾—
const examples = await prisma.problem.findMany({
  where: {
    patternId: 'pattern_123',
  },
  orderBy: {
    patternOrder: 'asc',
  },
});

// é€šå¸¸å•é¡Œã‚’å–å¾—ï¼ˆãƒ‘ã‚¿ãƒ¼ãƒ³å­¦ç¿’ã®å•é¡Œã‚‚å«ã‚€ï¼‰
const allProblems = await prisma.problem.findMany({
  where: {
    wordCount: { gte: 3, lte: 7 },
    audioReady: true,
    // patternIdãŒã‚ã£ã¦ã‚‚ãªãã¦ã‚‚å…¨éƒ¨å–å¾—ã•ã‚Œã‚‹
  },
});

// ãƒ‘ã‚¿ãƒ¼ãƒ³å­¦ç¿’å°‚ç”¨ã®å•é¡Œã ã‘é™¤å¤–ã—ãŸã„å ´åˆ
const onlyStandalone = await prisma.problem.findMany({
  where: {
    wordCount: { gte: 3, lte: 7 },
    patternId: null, // ãƒ‘ã‚¿ãƒ¼ãƒ³å­¦ç¿’ã«å±ã•ãªã„å•é¡Œã®ã¿
  },
});
```

### ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚³ãƒãƒ³ãƒ‰

```bash
# ã‚¹ã‚­ãƒ¼ãƒå¤‰æ›´å¾Œã€ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ç”Ÿæˆ
npx prisma migrate dev --name add_pattern_learning_to_problems

# æœ¬ç•ªç’°å¢ƒã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤
npx prisma migrate deploy
```

**ä¸»ãªå¤‰æ›´ç‚¹:**

- `Problem`ãƒ†ãƒ¼ãƒ–ãƒ«ã«`patternId`ã€`patternOrder`ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’è¿½åŠ 
- æ–°è¦ãƒ†ãƒ¼ãƒ–ãƒ«: `PatternSet`ã€`PatternTestProblem`
- æ–°ã—ã„enum: `DifficultyLevel`
- æ–°ã—ã„ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹: `problems`ã®`[patternId, patternOrder]`

---

## éŸ³å£°ç”Ÿæˆã®å®Ÿè£…

### æ—¢å­˜ã®éŸ³å£°ç”Ÿæˆã‚·ã‚¹ãƒ†ãƒ ã®æ´»ç”¨

ç¾åœ¨ã®ã‚·ã‚¹ãƒ†ãƒ ã¯OpenAI TTS APIã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚ãƒ‘ã‚¿ãƒ¼ãƒ³å­¦ç¿’ã§ã‚‚åŒã˜ã‚¤ãƒ³ãƒ•ãƒ©ã‚’æµç”¨ã—ã¾ã™ã€‚

### éŸ³å£°ç”Ÿæˆã®æµã‚Œ

```
1. ãƒ†ã‚­ã‚¹ãƒˆæº–å‚™ â†’ 2. OpenAI TTS API â†’ 3. Bufferå–å¾— â†’ 4. R2ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ â†’ 5. URLã‚’DBã«ä¿å­˜
```

### å®Ÿè£…ã‚³ãƒ¼ãƒ‰

#### `/src/lib/pattern-audio-generator.ts` (æ–°è¦ä½œæˆ)

```typescript
import { generateSpeechBuffer } from '@/lib/audio-utils';
import { uploadAudioToR2 } from '@/lib/r2-client';
import type { VoiceGender } from '@/config/voice';
import type { VoiceType } from '@prisma/client';

/**
 * VoiceTypeã‚’VoiceGenderã«å¤‰æ›
 */
function voiceTypeToGender(voiceType: VoiceType): VoiceGender {
  return voiceType as VoiceGender;
}

/**
 * ãƒ‘ã‚¿ãƒ¼ãƒ³ä¾‹æ–‡ã®éŸ³å£°ã‚’ç”Ÿæˆã—ã¦R2ã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
 */
export async function generatePatternExampleAudio(
  exampleId: string,
  englishSentence: string,
  japaneseReply: string,
  englishReply: string,
  senderVoice: VoiceType,
  receiverVoice: VoiceType,
): Promise<{
  audioEnUrl: string;
  audioJaUrl: string;
  audioEnReplyUrl: string;
}> {
  console.log(`[Pattern Audio] éŸ³å£°ç”Ÿæˆé–‹å§‹: ${exampleId}`);

  // 3ã¤ã®éŸ³å£°ã‚’ä¸¦åˆ—ç”Ÿæˆ
  const [enBuffer, jaBuffer, enReplyBuffer] = await Promise.all([
    generateSpeechBuffer(englishSentence, voiceTypeToGender(senderVoice)),
    generateSpeechBuffer(japaneseReply, voiceTypeToGender(receiverVoice)),
    generateSpeechBuffer(englishReply, voiceTypeToGender(receiverVoice)),
  ]);

  console.log(`[Pattern Audio] éŸ³å£°ãƒãƒƒãƒ•ã‚¡ç”Ÿæˆå®Œäº†`);

  // 3ã¤ã®éŸ³å£°ã‚’ä¸¦åˆ—ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
  const [audioEnUrl, audioJaUrl, audioEnReplyUrl] = await Promise.all([
    uploadAudioToR2(enBuffer, exampleId, 'en', voiceTypeToGender(senderVoice)),
    uploadAudioToR2(jaBuffer, exampleId, 'ja', voiceTypeToGender(receiverVoice)),
    uploadAudioToR2(enReplyBuffer, exampleId, 'en-reply', voiceTypeToGender(receiverVoice)),
  ]);

  console.log(`[Pattern Audio] R2ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å®Œäº†`);

  return {
    audioEnUrl,
    audioJaUrl,
    audioEnReplyUrl,
  };
}

/**
 * ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒ†ã‚¹ãƒˆå•é¡Œã®éŸ³å£°ã‚’ç”Ÿæˆã—ã¦R2ã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
 */
export async function generatePatternTestAudio(
  testId: string,
  englishSentence: string,
  senderVoice: VoiceType,
): Promise<string> {
  console.log(`[Pattern Test Audio] éŸ³å£°ç”Ÿæˆé–‹å§‹: ${testId}`);

  const audioBuffer = await generateSpeechBuffer(englishSentence, voiceTypeToGender(senderVoice));

  const audioUrl = await uploadAudioToR2(audioBuffer, testId, 'en', voiceTypeToGender(senderVoice));

  console.log(`[Pattern Test Audio] éŸ³å£°ç”Ÿæˆå®Œäº†: ${audioUrl}`);

  return audioUrl;
}
```

### éŸ³å£°ç”Ÿæˆã®ã‚³ã‚¹ãƒˆè¦‹ç©ã‚‚ã‚Š

OpenAI TTS Pricing (2025å¹´10æœˆæ™‚ç‚¹):

- gpt-4o-mini-tts: **$0.15 / 1M characters**
- gpt-4o-tts: $0.30 / 1M characters

#### ãƒ‘ã‚¿ãƒ¼ãƒ³å­¦ç¿’1ã‚»ãƒƒãƒˆã‚ãŸã‚Šã®ã‚³ã‚¹ãƒˆè¨ˆç®—

**å‰æ:**

- 1ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚»ãƒƒãƒˆ = 3ä¾‹æ–‡ + 1ãƒ†ã‚¹ãƒˆå•é¡Œ
- 1ä¾‹æ–‡ = è‹±èªæ–‡(10å˜èª) + è‹±èªè¿”ç­”(8å˜èª) + æ—¥æœ¬èªè¿”ç­”(10æ–‡å­—)
- 1ãƒ†ã‚¹ãƒˆå•é¡Œ = è‹±èªæ–‡(10å˜èª)

**è¨ˆç®—:**

```
ä¾‹æ–‡1ã¤ã‚ãŸã‚Š:
  - è‹±èªæ–‡: 10å˜èª Ã— 6æ–‡å­—/å˜èª = 60æ–‡å­—
  - è‹±èªè¿”ç­”: 8å˜èª Ã— 6æ–‡å­—/å˜èª = 48æ–‡å­—
  - æ—¥æœ¬èªè¿”ç­”: 10æ–‡å­—
  - å°è¨ˆ: 118æ–‡å­—

1ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚»ãƒƒãƒˆ:
  - ä¾‹æ–‡3ã¤: 118 Ã— 3 = 354æ–‡å­—
  - ãƒ†ã‚¹ãƒˆ1ã¤: 60æ–‡å­—
  - åˆè¨ˆ: 414æ–‡å­—

100ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚»ãƒƒãƒˆ:
  - 414æ–‡å­— Ã— 100 = 41,400æ–‡å­—
  - ã‚³ã‚¹ãƒˆ: $0.15 Ã— (41,400 / 1,000,000) = $0.0062 â‰ˆ 0.9å††

1000ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚»ãƒƒãƒˆ:
  - ç´„9å††
```

**çµè«–:** éŸ³å£°ç”Ÿæˆã®ã‚³ã‚¹ãƒˆã¯éå¸¸ã«å®‰ã„ï¼

---

## ç”»åƒç”Ÿæˆã®å®Ÿè£…

### æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ ã‚’æµç”¨

**æœ—å ±**: `/src/lib/problem-generator.ts`ã®`generateImagePrompt()`é–¢æ•°ãŒãã®ã¾ã¾ä½¿ãˆã¾ã™ï¼

æ—¢å­˜ã®å®Ÿè£…ã¯ååˆ†ã«æ´—ç·´ã•ã‚Œã¦ãŠã‚Šã€ãƒ‘ã‚¿ãƒ¼ãƒ³å­¦ç¿’ã§ã‚‚åŒã˜ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç”Ÿæˆãƒ­ã‚¸ãƒƒã‚¯ã‚’æµç”¨ã§ãã¾ã™ã€‚

```typescript
// æ—¢å­˜ã®å®Ÿè£…ã‚’ãã®ã¾ã¾ä½¿ç”¨
import { generateImagePrompt, generateAndUploadImageAsset } from '@/lib/problem-generator';
```

### ç”»åƒç”Ÿæˆã®æµã‚Œ

```
1. ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç”Ÿæˆï¼ˆæ—¢å­˜é–¢æ•°ï¼‰ â†’ 2. OpenAI DALL-E 3 â†’ 3. Bufferå–å¾— â†’ 4. WebPå¤‰æ› â†’ 5. R2ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
```

### ãƒ‘ã‚¿ãƒ¼ãƒ³ä¾‹æ–‡ç”¨ã®ç”»åƒç”Ÿæˆ

```typescript
// /src/lib/pattern-image-generator.tsï¼ˆæ–°è¦ä½œæˆï¼‰

import { generateAndUploadImageAsset } from '@/lib/problem-generator';
import type { Problem } from '@prisma/client';

/**
 * ãƒ‘ã‚¿ãƒ¼ãƒ³ä¾‹æ–‡ç”¨ã®ç”»åƒã‚’ç”Ÿæˆã—ã¦R2ã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
 * æ—¢å­˜ã®problem-generatorã®é–¢æ•°ã‚’æµç”¨
 *
 * æ³¨: Problemã¨PatternExampleã¯åŒã˜æ§‹é€ ãªã®ã§ã€ãã®ã¾ã¾ä½¿ãˆã‚‹ï¼
 */
export async function generatePatternExampleImage(
  exampleId: string,
  example: Pick<
    Problem,
    | 'englishSentence'
    | 'japaneseSentence'
    | 'englishReply'
    | 'japaneseReply'
    | 'place'
    | 'senderRole'
    | 'receiverRole'
    | 'senderVoice'
    | 'receiverVoice'
  >,
): Promise<string> {
  console.log(`[Pattern Image] ç”»åƒç”Ÿæˆé–‹å§‹: ${exampleId}`);

  // æ—¢å­˜ã®é–¢æ•°ã‚’ãã®ã¾ã¾ä½¿ç”¨
  const imageUrl = await generateAndUploadImageAsset(
    {
      englishSentence: example.englishSentence,
      japaneseSentence: example.japaneseSentence,
      englishReply: example.englishReply,
      japaneseReply: example.japaneseReply,
      place: example.place,
      senderRole: example.senderRole,
      receiverRole: example.receiverRole,
      senderVoice: example.senderVoice,
      receiverVoice: example.receiverVoice,
      wordCount: 0, // ãƒ€ãƒŸãƒ¼å€¤
      incorrectOptions: [], // ãƒ€ãƒŸãƒ¼å€¤
    },
    exampleId,
  );

  console.log(`[Pattern Image] ç”»åƒç”Ÿæˆå®Œäº†: ${imageUrl}`);

  return imageUrl;
}
```

### ç”»åƒç”Ÿæˆã®ã‚³ã‚¹ãƒˆè¦‹ç©ã‚‚ã‚Š

OpenAI DALL-E 3 Pricing (2025å¹´10æœˆæ™‚ç‚¹):

- Standard quality (1024Ã—1024): **$0.040 / image**
- HD quality (1024Ã—1792): $0.080 / image

#### ãƒ‘ã‚¿ãƒ¼ãƒ³å­¦ç¿’1ã‚»ãƒƒãƒˆã‚ãŸã‚Šã®ã‚³ã‚¹ãƒˆè¨ˆç®—

**å‰æ:**

- 1ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚»ãƒƒãƒˆ = 3ä¾‹æ–‡ + 1ãƒ†ã‚¹ãƒˆå•é¡Œ
- å„ä¾‹æ–‡ã«1æšã®ç”»åƒ
- ãƒ†ã‚¹ãƒˆå•é¡Œã«1æšã®ç”»åƒï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

**è¨ˆç®—:**

```
ç”»åƒã‚ã‚Šã®å ´åˆï¼ˆå…¨ã¦ã«ç”»åƒï¼‰:
  - ä¾‹æ–‡3ã¤: $0.040 Ã— 3 = $0.12
  - ãƒ†ã‚¹ãƒˆ1ã¤: $0.040 Ã— 1 = $0.04
  - åˆè¨ˆ: $0.16 â‰ˆ 24å††

ç”»åƒãªã—ãƒ¢ãƒ¼ãƒ‰å¯¾å¿œï¼ˆä¾‹æ–‡ã®ã¿ç”»åƒï¼‰:
  - ä¾‹æ–‡3ã¤: $0.040 Ã— 3 = $0.12 â‰ˆ 18å††
  - ãƒ†ã‚¹ãƒˆ: ç”»åƒãªã—
  - åˆè¨ˆ: $0.12 â‰ˆ 18å††

100ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚»ãƒƒãƒˆ:
  - ç´„2,400å††ï¼ˆç”»åƒã‚ã‚Šï¼‰
  - ç´„1,800å††ï¼ˆä¾‹æ–‡ã®ã¿ï¼‰
```

**ã‚³ã‚¹ãƒˆå‰Šæ¸›ç­–:**

1. **ç”»åƒã®å†åˆ©ç”¨**: åŒã˜å ´æ‰€ãƒ»ã‚·ãƒãƒ¥ã‚¨ãƒ¼ã‚·ãƒ§ãƒ³ã®ç”»åƒã‚’è¤‡æ•°ãƒ‘ã‚¿ãƒ¼ãƒ³ã§å…±æœ‰
2. **ç”»åƒãªã—ãƒ¢ãƒ¼ãƒ‰**: ãƒ†ã‚¹ãƒˆå•é¡Œã§ã¯ç”»åƒã‚’ç”Ÿæˆã—ãªã„
3. **é…å»¶ç”Ÿæˆ**: æœ€åˆã¯ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ç”»åƒã‚’ä½¿ã„ã€ã‚¢ã‚¯ã‚»ã‚¹ã•ã‚ŒãŸã‚‰ç”Ÿæˆ

---

## å®Ÿè£…ã‚³ãƒ¼ãƒ‰ä¾‹

### APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

#### `/src/app/api/pattern-learning/route.ts` (æ–°è¦ä½œæˆ)

```typescript
import { NextRequest, NextResponse } from 'next/server';
import { prisma } from '@/lib/prisma';

/**
 * GET /api/pattern-learning?difficulty=beginner
 * æŒ‡å®šé›£æ˜“åº¦ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚»ãƒƒãƒˆä¸€è¦§ã‚’å–å¾—
 */
export async function GET(request: NextRequest) {
  try {
    const searchParams = request.nextUrl.searchParams;
    const difficulty = searchParams.get('difficulty') || 'beginner';

    if (!['beginner', 'intermediate', 'advanced'].includes(difficulty)) {
      return NextResponse.json({ error: 'Invalid difficulty level' }, { status: 400 });
    }

    const patternSets = await prisma.patternSet.findMany({
      where: {
        difficulty: difficulty as 'beginner' | 'intermediate' | 'advanced',
      },
      select: {
        id: true,
        patternName: true,
        patternDescription: true,
        difficulty: true,
        createdAt: true,
        // âœ¨ examplesã¯Problemã®é…åˆ—
        examples: {
          select: {
            id: true,
          },
        },
      },
      orderBy: {
        createdAt: 'desc',
      },
    });

    const patternSetsWithCount = patternSets.map((set) => ({
      id: set.id,
      patternName: set.patternName,
      patternDescription: set.patternDescription,
      difficulty: set.difficulty,
      exampleCount: set.examples.length,
      createdAt: set.createdAt,
    }));

    return NextResponse.json({
      patternSets: patternSetsWithCount,
      count: patternSetsWithCount.length,
    });
  } catch (error) {
    console.error('[API] Pattern learning list error:', error);
    return NextResponse.json({ error: 'Failed to fetch pattern sets' }, { status: 500 });
  }
}
```

#### `/src/app/api/pattern-learning/[patternId]/route.ts` (æ–°è¦ä½œæˆ)

```typescript
import { NextRequest, NextResponse } from 'next/server';
import { prisma } from '@/lib/prisma';

/**
 * GET /api/pattern-learning/:patternId
 * ç‰¹å®šã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚»ãƒƒãƒˆã®è©³ç´°ã‚’å–å¾—ï¼ˆä¾‹æ–‡ãƒ»ãƒ†ã‚¹ãƒˆå•é¡Œè¾¼ã¿ï¼‰
 */
export async function GET(request: NextRequest, { params }: { params: { patternId: string } }) {
  try {
    const { patternId } = params;

    const patternSet = await prisma.patternSet.findUnique({
      where: {
        id: patternId,
      },
      include: {
        // âœ¨ examplesã¯Problemãƒ†ãƒ¼ãƒ–ãƒ«ã‹ã‚‰å–å¾—
        examples: {
          orderBy: {
            patternOrder: 'asc', // orderã§ã¯ãªãpatternOrder
          },
        },
        testProblem: true,
      },
    });

    if (!patternSet) {
      return NextResponse.json({ error: 'Pattern set not found' }, { status: 404 });
    }

    // incorrectOptionsã¨additionalExamplesã‚’ãƒ‘ãƒ¼ã‚¹
    const testProblem = patternSet.testProblem
      ? {
          ...patternSet.testProblem,
          incorrectOptions: Array.isArray(patternSet.testProblem.incorrectOptions)
            ? patternSet.testProblem.incorrectOptions
            : JSON.parse(patternSet.testProblem.incorrectOptions as string),
        }
      : null;

    const additionalExamples = patternSet.additionalExamples
      ? Array.isArray(patternSet.additionalExamples)
        ? patternSet.additionalExamples
        : JSON.parse(patternSet.additionalExamples as string)
      : [];

    return NextResponse.json({
      patternSet: {
        ...patternSet,
        testProblem,
        additionalExamples,
      },
    });
  } catch (error) {
    console.error('[API] Pattern learning detail error:', error);
    return NextResponse.json({ error: 'Failed to fetch pattern set' }, { status: 500 });
  }
}
```

### ãƒšãƒ¼ã‚¸ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

#### `/src/app/pattern-learning/page.tsx` (æ–°è¦ä½œæˆ)

```typescript
import Link from 'next/link';

export default function PatternLearningPage() {
  const difficulties = [
    {
      level: 'beginner',
      title: 'åˆç´š',
      description: 'åŸºæœ¬çš„ãªæ—¥å¸¸ä¼šè©±ãƒ‘ã‚¿ãƒ¼ãƒ³',
      color: 'from-green-400 to-emerald-500',
    },
    {
      level: 'intermediate',
      title: 'ä¸­ç´š',
      description: 'ã‚ˆã‚Šè¤‡é›‘ãªè¡¨ç¾ãƒ‘ã‚¿ãƒ¼ãƒ³',
      color: 'from-blue-400 to-cyan-500',
    },
    {
      level: 'advanced',
      title: 'ä¸Šç´š',
      description: 'ãƒ“ã‚¸ãƒã‚¹ã‚„å°‚é–€çš„ãªãƒ‘ã‚¿ãƒ¼ãƒ³',
      color: 'from-purple-400 to-pink-500',
    },
  ];

  return (
    <main className="min-h-screen bg-gradient-to-b from-[#f4f1ea] to-white p-8">
      <div className="max-w-5xl mx-auto">
        <header className="text-center mb-12">
          <h1 className="text-4xl font-bold text-[#2a2b3c] mb-4">
            ãƒ‘ã‚¿ãƒ¼ãƒ³å­¦ç¿’ãƒ¢ãƒ¼ãƒ‰
          </h1>
          <p className="text-lg text-[#2a2b3c]/70">
            è¤‡æ•°ã®ä¾‹ã‹ã‚‰è‹±èªã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’è¦‹ã¤ã‘ã¦ã€è‡ªç„¶ã«ç†è§£ã—ã‚ˆã†
          </p>
        </header>

        <section className="grid md:grid-cols-3 gap-6">
          {difficulties.map((diff) => (
            <Link
              key={diff.level}
              href={`/pattern-learning/${diff.level}`}
              className="group"
            >
              <div className="bg-white rounded-3xl border border-[#d8cbb6] p-8 shadow-lg hover:shadow-xl transition-all hover:-translate-y-1">
                <div
                  className={`w-16 h-16 rounded-2xl bg-gradient-to-br ${diff.color} mb-4 flex items-center justify-center text-white font-bold text-2xl`}
                >
                  {diff.level[0].toUpperCase()}
                </div>
                <h2 className="text-2xl font-bold text-[#2a2b3c] mb-2">
                  {diff.title}
                </h2>
                <p className="text-[#2a2b3c]/70">{diff.description}</p>
              </div>
            </Link>
          ))}
        </section>

        <section className="mt-16 bg-gradient-to-r from-blue-50 to-teal-50 rounded-3xl p-8 border border-blue-200">
          <h2 className="text-2xl font-bold text-[#2f8f9d] mb-4">
            ãƒ‘ã‚¿ãƒ¼ãƒ³å­¦ç¿’ã¨ã¯ï¼Ÿ
          </h2>
          <div className="grid md:grid-cols-2 gap-6 text-[#2a2b3c]">
            <div>
              <h3 className="font-semibold mb-2">ğŸ§© ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ç™ºè¦‹</h3>
              <p className="text-sm text-[#2a2b3c]/70">
                3ã€œ5å€‹ã®é¡ä¼¼ã—ãŸä¾‹æ–‡ã‚’è¦‹ã¦ã€å…±é€šã™ã‚‹ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’è¦‹ã¤ã‘ã¾ã™
              </p>
            </div>
            <div>
              <h3 className="font-semibold mb-2">ğŸ¯ è‡ªç„¶ãªç†è§£</h3>
              <p className="text-sm text-[#2a2b3c]/70">
                æš—è¨˜ã§ã¯ãªãã€å·®åˆ†ã‹ã‚‰æ§‹é€ ã‚’ç†è§£ã™ã‚‹è‡ªç„¶ãªå­¦ç¿’æ³•
              </p>
            </div>
            <div>
              <h3 className="font-semibold mb-2">âœ… ç†è§£åº¦ãƒ†ã‚¹ãƒˆ</h3>
              <p className="text-sm text-[#2a2b3c]/70">
                æ–°ã—ã„å˜èªã§ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å¿œç”¨ã§ãã‚‹ã‹ãƒ†ã‚¹ãƒˆã—ã¾ã™
              </p>
            </div>
            <div>
              <h3 className="font-semibold mb-2">ğŸ”— é–¢é€£ãƒ‘ã‚¿ãƒ¼ãƒ³</h3>
              <p className="text-sm text-[#2a2b3c]/70">
                ä¼¼ãŸãƒ‘ã‚¿ãƒ¼ãƒ³ã‚„é–¢é€£è¡¨ç¾ã‚‚ä¸€ç·’ã«å­¦ç¿’ã§ãã¾ã™
              </p>
            </div>
          </div>
        </section>
      </div>
    </main>
  );
}
```

---

## ã‚·ãƒ¼ãƒ‰ç”Ÿæˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ

### `/scripts/seed-pattern-learning.ts` (æ–°è¦ä½œæˆ)

```typescript
import { PrismaClient } from '@prisma/client';
import {
  generatePatternExampleAudio,
  generatePatternTestAudio,
} from '../src/lib/pattern-audio-generator';
import { generatePatternExampleImage } from '../src/lib/pattern-image-generator';
import { countWords } from '../src/config/problem';

const prisma = new PrismaClient();

/**
 * ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚»ãƒƒãƒˆã®å®šç¾©ï¼ˆTypeScriptå‹ï¼‰
 */
type PatternSetDefinition = {
  patternName: string; // "Can you pass me the ã€‡ã€‡ã€‡?"
  patternMeaning: string; // "ã€‡ã€‡ã€‡ã‚’å–ã£ã¦ãã‚Œã¾ã›ã‚“ã‹ï¼Ÿ"
  patternDescription: string;
  difficulty: 'beginner' | 'intermediate' | 'advanced';
  examples: Array<{
    order: number;
    englishSentence: string;
    japaneseSentence: string;
    place: string;
    senderRole: string;
    receiverRole: string;
    senderVoice: 'male' | 'female';
    receiverVoice: 'male' | 'female';
    englishReply: string;
    japaneseReply: string;
  }>;
  testProblem: {
    questionPattern: string; // "Can you pass me the ã€‡ã€‡ã€‡?"
    correctAnswer: string; // "ã€‡ã€‡ã€‡ã‚’å–ã£ã¦ãã‚Œã¾ã›ã‚“ã‹ï¼Ÿ"
    incorrectOptions: string[];
  };
  additionalExamples?: Array<{
    english: string;
    japanese: string;
  }>;
  relatedPatternIds?: string[];
};

/**
 * åˆç´šãƒ‘ã‚¿ãƒ¼ãƒ³ã‚»ãƒƒãƒˆã®ãƒ‡ãƒ¼ã‚¿
 */
const beginnerPatterns: PatternSetDefinition[] = [
  {
    patternName: 'Can you pass me the ã€‡ã€‡ã€‡?',
    patternMeaning: 'ã€‡ã€‡ã€‡ã‚’å–ã£ã¦ãã‚Œã¾ã›ã‚“ã‹ï¼Ÿ',
    patternDescription: 'ç‰©ã‚’å–ã£ã¦ã‚‚ã‚‰ã†ä¾é ¼è¡¨ç¾',
    difficulty: 'beginner',
    examples: [
      {
        order: 1,
        englishSentence: 'Can you pass me the salt?',
        japaneseSentence: 'ãŠå¡©ã‚’å–ã£ã¦ãã‚Œãªã„ï¼Ÿ',
        place: 'é£Ÿå“',
        senderRole: 'å¦»',
        receiverRole: 'å¤«',
        senderVoice: 'female',
        receiverVoice: 'male',
        englishReply: 'Sure, here you go.',
        japaneseReply: 'ã¯ã„ã€ã©ã†ã',
      },
      {
        order: 2,
        englishSentence: 'Can you pass me the remote?',
        japaneseSentence: 'ãƒªãƒ¢ã‚³ãƒ³ã‚’å–ã£ã¦ãã‚Œãªã„ï¼Ÿ',
        place: 'ãƒªãƒ“ãƒ³ã‚°',
        senderRole: 'å¤«',
        receiverRole: 'å¦»',
        senderVoice: 'male',
        receiverVoice: 'female',
        englishReply: 'Here it is.',
        japaneseReply: 'ã¯ã„ã€ã©ã†ã',
      },
      {
        order: 3,
        englishSentence: 'Can you pass me the pen?',
        japaneseSentence: 'ãƒšãƒ³ã‚’å–ã£ã¦ãã‚Œãªã„ï¼Ÿ',
        place: 'ã‚ªãƒ•ã‚£ã‚¹',
        senderRole: 'åŒåƒš',
        receiverRole: 'åŒåƒš',
        senderVoice: 'female',
        receiverVoice: 'male',
        englishReply: 'Sure, which one?',
        japaneseReply: 'ã„ã„ã‚ˆã€ã©ã‚Œï¼Ÿ',
      },
    ],
    testProblem: {
      questionPattern: 'Can you pass me the ã€‡ã€‡ã€‡?',
      correctAnswer: 'ã€‡ã€‡ã€‡ã‚’å–ã£ã¦ãã‚Œã¾ã›ã‚“ã‹ï¼Ÿ',
      incorrectOptions: ['ã€‡ã€‡ã€‡ã‚’è²·ã„ã«è¡Œãã¾ã—ã‚‡ã†', 'ã€‡ã€‡ã€‡ãŒå¥½ãã§ã™', 'ã€‡ã€‡ã€‡ã¯ã©ã“ã§ã™ã‹ï¼Ÿ'],
    },
    additionalExamples: [
      { english: 'Can you pass me the book?', japanese: 'æœ¬ã‚’å–ã£ã¦ãã‚Œã¾ã›ã‚“ã‹ï¼Ÿ' },
      { english: 'Can you pass me the water?', japanese: 'æ°´ã‚’å–ã£ã¦ãã‚Œã¾ã›ã‚“ã‹ï¼Ÿ' },
      { english: 'Can you pass me the phone?', japanese: 'é›»è©±ã‚’å–ã£ã¦ãã‚Œã¾ã›ã‚“ã‹ï¼Ÿ' },
    ],
  },
  {
    patternName: 'I want to ã€‡ã€‡ã€‡',
    patternMeaning: 'ã€‡ã€‡ã€‡ã—ãŸã„',
    patternDescription: 'å¸Œæœ›ã‚’ä¼ãˆã‚‹è¡¨ç¾',
    difficulty: 'beginner',
    examples: [
      {
        order: 1,
        englishSentence: 'I want to eat pizza.',
        japaneseSentence: 'ãƒ”ã‚¶ãŒé£Ÿã¹ãŸã„ãª',
        place: 'ãƒªãƒ“ãƒ³ã‚°',
        senderRole: 'å­ä¾›',
        receiverRole: 'æ¯è¦ª',
        senderVoice: 'male',
        receiverVoice: 'female',
        englishReply: "Let's order some!",
        japaneseReply: 'æ³¨æ–‡ã—ã¾ã—ã‚‡ã†ï¼',
      },
      {
        order: 2,
        englishSentence: 'I want to watch a movie.',
        japaneseSentence: 'æ˜ ç”»ãŒè¦‹ãŸã„ãª',
        place: 'ãƒªãƒ“ãƒ³ã‚°',
        senderRole: 'å¤«',
        receiverRole: 'å¦»',
        senderVoice: 'male',
        receiverVoice: 'female',
        englishReply: 'What kind of movie?',
        japaneseReply: 'ã©ã‚“ãªæ˜ ç”»ï¼Ÿ',
      },
      {
        order: 3,
        englishSentence: 'I want to go shopping.',
        japaneseSentence: 'è²·ã„ç‰©ã«è¡ŒããŸã„ãª',
        place: 'ãƒªãƒ“ãƒ³ã‚°',
        senderRole: 'å¦»',
        receiverRole: 'å¤«',
        senderVoice: 'female',
        receiverVoice: 'male',
        englishReply: 'Sure, when?',
        japaneseReply: 'ã„ã„ã‚ˆã€ã„ã¤ï¼Ÿ',
      },
    ],
    testProblem: {
      questionPattern: 'I want to ã€‡ã€‡ã€‡',
      correctAnswer: 'ã€‡ã€‡ã€‡ã—ãŸã„',
      incorrectOptions: ['ã€‡ã€‡ã€‡ã‚’è²·ã„ãŸã„', 'ã€‡ã€‡ã€‡ã‚’è¦‹ãŸã„', 'ã€‡ã€‡ã€‡ã¯ã©ã“ï¼Ÿ'],
    },
    additionalExamples: [
      { english: 'I want to play games.', japanese: 'ã‚²ãƒ¼ãƒ ãŒã—ãŸã„' },
      { english: 'I want to study English.', japanese: 'è‹±èªã‚’å‹‰å¼·ã—ãŸã„' },
      { english: 'I want to sleep.', japanese: 'å¯ãŸã„' },
    ],
  },
  {
    patternName: 'Where is ã€‡ã€‡ã€‡?',
    patternMeaning: 'ã€‡ã€‡ã€‡ã¯ã©ã“ã§ã™ã‹ï¼Ÿ',
    patternDescription: 'å ´æ‰€ã‚„ç‰©ã®ä½ç½®ã‚’å°‹ã­ã‚‹è¡¨ç¾',
    difficulty: 'beginner',
    examples: [
      {
        order: 1,
        englishSentence: 'Where is the bathroom?',
        japaneseSentence: 'ãƒˆã‚¤ãƒ¬ã¯ã©ã“ã§ã™ã‹ï¼Ÿ',
        place: 'ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³',
        senderRole: 'å®¢',
        receiverRole: 'åº—å“¡',
        senderVoice: 'male',
        receiverVoice: 'female',
        englishReply: "It's on the second floor.",
        japaneseReply: '2éšã§ã™',
      },
      {
        order: 2,
        englishSentence: 'Where is the station?',
        japaneseSentence: 'é§…ã¯ã©ã“ã§ã™ã‹ï¼Ÿ',
        place: 'é“',
        senderRole: 'è¦³å…‰å®¢',
        receiverRole: 'åœ°å…ƒã®äºº',
        senderVoice: 'female',
        receiverVoice: 'male',
        englishReply: "It's that way.",
        japaneseReply: 'ã‚ã£ã¡ã§ã™',
      },
      {
        order: 3,
        englishSentence: 'Where is my phone?',
        japaneseSentence: 'ç§ã®æºå¸¯ã¯ã©ã“ï¼Ÿ',
        place: 'ãƒªãƒ“ãƒ³ã‚°',
        senderRole: 'å¦»',
        receiverRole: 'å¤«',
        senderVoice: 'female',
        receiverVoice: 'male',
        englishReply: "It's on the table.",
        japaneseReply: 'ãƒ†ãƒ¼ãƒ–ãƒ«ã®ä¸Šã ã‚ˆ',
      },
    ],
    testProblem: {
      questionPattern: 'Where is ã€‡ã€‡ã€‡?',
      correctAnswer: 'ã€‡ã€‡ã€‡ã¯ã©ã“ã§ã™ã‹ï¼Ÿ',
      incorrectOptions: ['ã€‡ã€‡ã€‡ã«è¡ŒããŸã„', 'ã€‡ã€‡ã€‡ã§å‹‰å¼·ã—ã‚ˆã†', 'ã€‡ã€‡ã€‡ã¯é–‹ã„ã¦ã„ã¾ã™ã‹ï¼Ÿ'],
    },
    additionalExamples: [
      { english: 'Where is the library?', japanese: 'å›³æ›¸é¤¨ã¯ã©ã“ã§ã™ã‹ï¼Ÿ' },
      { english: 'Where is the exit?', japanese: 'å‡ºå£ã¯ã©ã“ã§ã™ã‹ï¼Ÿ' },
      { english: 'Where is my bag?', japanese: 'ç§ã®ãƒãƒƒã‚°ã¯ã©ã“ï¼Ÿ' },
    ],
  },
];

/**
 * ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚»ãƒƒãƒˆã‚’1ã¤ç”Ÿæˆã—ã¦DBã«ä¿å­˜
 */
async function seedPatternSet(definition: PatternSetDefinition) {
  console.log(`\n[Seed] ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚»ãƒƒãƒˆç”Ÿæˆé–‹å§‹: ${definition.patternName}`);

  // 1. ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚»ãƒƒãƒˆã‚’ä½œæˆ
  const patternSet = await prisma.patternSet.create({
    data: {
      patternName: definition.patternName,
      patternMeaning: definition.patternMeaning,
      patternDescription: definition.patternDescription,
      difficulty: definition.difficulty,
      additionalExamples: definition.additionalExamples
        ? JSON.stringify(definition.additionalExamples)
        : null,
      relatedPatternIds: definition.relatedPatternIds || [],
    },
  });

  console.log(`[Seed] ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚»ãƒƒãƒˆä½œæˆå®Œäº†: ${patternSet.id}`);

  // 2. å„ä¾‹æ–‡ã‚’ç”Ÿæˆ
  for (const exampleDef of definition.examples) {
    console.log(`[Seed] ä¾‹æ–‡ ${exampleDef.order} ç”Ÿæˆä¸­...`);

    // éŸ³å£°ã¨ç”»åƒã‚’ä¸¦åˆ—ç”Ÿæˆ
    const [audioUrls, imageUrl] = await Promise.all([
      generatePatternExampleAudio(
        `${patternSet.id}_example_${exampleDef.order}`,
        exampleDef.englishSentence,
        exampleDef.japaneseReply,
        exampleDef.englishReply,
        exampleDef.senderVoice,
        exampleDef.receiverVoice,
      ),
      generatePatternExampleImage(`${patternSet.id}_example_${exampleDef.order}`, exampleDef),
    ]);

    // âœ¨ DBã«ä¿å­˜ï¼ˆProblemãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½¿ã†ï¼ï¼‰
    await prisma.problem.create({
      data: {
        // ãƒ‘ã‚¿ãƒ¼ãƒ³å­¦ç¿’ç”¨ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
        patternId: patternSet.id,
        patternOrder: exampleDef.order,

        // é€šå¸¸ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
        wordCount: countWords(exampleDef.englishSentence),
        englishSentence: exampleDef.englishSentence,
        japaneseSentence: exampleDef.japaneseSentence,
        place: exampleDef.place,
        senderRole: exampleDef.senderRole,
        receiverRole: exampleDef.receiverRole,
        senderVoice: exampleDef.senderVoice,
        receiverVoice: exampleDef.receiverVoice,
        englishReply: exampleDef.englishReply,
        japaneseReply: exampleDef.japaneseReply,

        // incorrectOptionsã¯ç©ºé…åˆ—ï¼ˆãƒ‘ã‚¿ãƒ¼ãƒ³å­¦ç¿’ã§ã¯å€‹åˆ¥å•é¡Œã¨ã—ã¦å‡ºã•ãªã„ï¼‰
        incorrectOptions: JSON.stringify([]),

        // ãƒ¡ãƒ‡ã‚£ã‚¢
        audioEnUrl: audioUrls.audioEnUrl,
        audioJaUrl: audioUrls.audioJaUrl,
        audioEnReplyUrl: audioUrls.audioEnReplyUrl,
        imageUrl: imageUrl,
        audioReady: true,
      },
    });

    console.log(`[Seed] ä¾‹æ–‡ ${exampleDef.order} å®Œäº†`);
  }

  // 3. ãƒ†ã‚¹ãƒˆå•é¡Œã‚’ç”Ÿæˆ
  console.log(`[Seed] ãƒ†ã‚¹ãƒˆå•é¡Œç”Ÿæˆä¸­...`);

  await prisma.patternTestProblem.create({
    data: {
      patternSetId: patternSet.id,
      questionPattern: definition.testProblem.questionPattern,
      correctAnswer: definition.testProblem.correctAnswer,
      incorrectOptions: JSON.stringify(definition.testProblem.incorrectOptions),
    },
  });

  console.log(`[Seed] ãƒ†ã‚¹ãƒˆå•é¡Œå®Œäº†`);
  console.log(`[Seed] ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚»ãƒƒãƒˆå®Œäº†: ${definition.patternName}\n`);

  return patternSet;
}

/**
 * ãƒ¡ã‚¤ãƒ³å®Ÿè¡Œé–¢æ•°
 */
async function main() {
  console.log('[Seed] ãƒ‘ã‚¿ãƒ¼ãƒ³å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã®ã‚·ãƒ¼ãƒ‰é–‹å§‹');

  // æ—¢å­˜ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚»ãƒƒãƒˆã‚’å‰Šé™¤ï¼ˆé–‹ç™ºç’°å¢ƒã®ã¿ï¼‰
  if (process.env.NODE_ENV === 'development') {
    console.log('[Seed] æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤ä¸­...');
    await prisma.patternTestProblem.deleteMany({});
    // âœ¨ PatternExampleã§ã¯ãªãã€patternIdä»˜ãã®Problemã‚’å‰Šé™¤
    await prisma.problem.deleteMany({
      where: {
        patternId: { not: null },
      },
    });
    await prisma.patternSet.deleteMany({});
    console.log('[Seed] å‰Šé™¤å®Œäº†');
  }

  // å„ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚»ãƒƒãƒˆã‚’ç”Ÿæˆ
  for (const pattern of beginnerPatterns) {
    await seedPatternSet(pattern);
  }

  console.log('[Seed] å…¨ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚»ãƒƒãƒˆã®ç”Ÿæˆå®Œäº†ï¼');
}

main()
  .catch((e) => {
    console.error('[Seed] ã‚¨ãƒ©ãƒ¼:', e);
    process.exit(1);
  })
  .finally(async () => {
    await prisma.$disconnect();
  });
```

### ã‚·ãƒ¼ãƒ‰å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰

```bash
# TypeScriptã‚’ç›´æ¥å®Ÿè¡Œ
npx tsx scripts/seed-pattern-learning.ts

# ã¾ãŸã¯ package.json ã«è¿½åŠ 
# "scripts": {
#   "seed:pattern": "tsx scripts/seed-pattern-learning.ts"
# }
npm run seed:pattern
```

---

## æ®µéšçš„ãªå®Ÿè£…è¨ˆç”»

### Phase 1: åŸºæœ¬ã‚¤ãƒ³ãƒ•ãƒ©ï¼ˆ1-2æ—¥ï¼‰

- [x] Prismaã‚¹ã‚­ãƒ¼ãƒè¿½åŠ 
- [x] ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
- [x] éŸ³å£°ç”Ÿæˆãƒ©ã‚¤ãƒ–ãƒ©ãƒªä½œæˆ
- [x] ç”»åƒç”Ÿæˆãƒ©ã‚¤ãƒ–ãƒ©ãƒªä½œæˆ
- [x] R2ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ç¢ºèª

### Phase 2: ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆï¼ˆ2-3æ—¥ï¼‰

- [x] ã‚·ãƒ¼ãƒ‰ã‚¹ã‚¯ãƒªãƒ—ãƒˆä½œæˆ
- [x] åˆç´šãƒ‘ã‚¿ãƒ¼ãƒ³3ã‚»ãƒƒãƒˆã®ãƒ‡ãƒ¼ã‚¿å®šç¾©
- [x] éŸ³å£°ãƒ»ç”»åƒã®ä¸€æ‹¬ç”Ÿæˆ
- [x] DBã¸ã®ä¿å­˜ç¢ºèª

### Phase 3: APIå®Ÿè£…ï¼ˆ1-2æ—¥ï¼‰

- [x] ãƒ‘ã‚¿ãƒ¼ãƒ³ä¸€è¦§API
- [x] ãƒ‘ã‚¿ãƒ¼ãƒ³è©³ç´°API
- [x] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

### Phase 4: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰åŸºç¤ï¼ˆ3-4æ—¥ï¼‰

- [x] ãƒã‚¤ãƒ©ã‚¤ãƒˆè¡¨ç¤ºãƒ©ã‚¤ãƒ–ãƒ©ãƒª
- [x] ãƒ©ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ãƒšãƒ¼ã‚¸
- [x] é›£æ˜“åº¦é¸æŠãƒšãƒ¼ã‚¸
- [x] ãƒ‘ã‚¿ãƒ¼ãƒ³ä¸€è¦§ãƒšãƒ¼ã‚¸

### Phase 5: ãƒ¡ã‚¤ãƒ³ãƒ•ãƒ­ãƒ¼å®Ÿè£…ï¼ˆ5-7æ—¥ï¼‰

- [x] pattern-learning-flow.tsx
- [x] example-viewer.tsx
- [x] pattern-review.tsx
- [x] pattern-test.tsx
- [x] éŸ³å£°å†ç”Ÿåˆ¶å¾¡
- [x] ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³

### Phase 6: ãƒ†ã‚¹ãƒˆãƒ»æ”¹å–„ï¼ˆ2-3æ—¥ï¼‰

- [x] E2Eãƒ†ã‚¹ãƒˆ
- [x] éŸ³å£°ã‚¿ã‚¤ãƒŸãƒ³ã‚°èª¿æ•´
- [x] UI/UXãƒ–ãƒ©ãƒƒã‚·ãƒ¥ã‚¢ãƒƒãƒ—
- [x] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

**åˆè¨ˆ: ç´„2-3é€±é–“ã§å®Ÿè£…å¯èƒ½**

---

## ã‚ˆãã‚ã‚‹è³ªå•ï¼ˆFAQï¼‰

### Q1: ç”»åƒç”Ÿæˆã‚’ã‚¹ã‚­ãƒƒãƒ—ã§ãã¾ã™ã‹ï¼Ÿ

**A:** ã¯ã„ã€å¯èƒ½ã§ã™ã€‚`generateAndUploadPatternImage`ã®å‘¼ã³å‡ºã—ã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ã€`imageUrl`ã‚’nullã«ã™ã‚Œã°ç”»åƒãªã—ã§å‹•ä½œã—ã¾ã™ã€‚

```typescript
// ç”»åƒãªã—ãƒ¢ãƒ¼ãƒ‰
const imageUrl = null; // ç”»åƒç”Ÿæˆã‚’ã‚¹ã‚­ãƒƒãƒ—
```

ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã§ç”»åƒãŒãªã„å ´åˆã®ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯è¡¨ç¤ºã‚‚å®Ÿè£…æ¸ˆã¿ã§ã™ï¼ˆæ—¢å­˜ã®problem-flow.tsxã‚’å‚ç…§ï¼‰ã€‚

### Q2: éŸ³å£°è¨€èªã‚’å¤‰æ›´ã§ãã¾ã™ã‹ï¼Ÿ

**A:** ã¯ã„ã€‚OpenAI TTSã¯å¤šè¨€èªå¯¾å¿œãªã®ã§ã€å…¥åŠ›ãƒ†ã‚­ã‚¹ãƒˆã‚’å¤‰ãˆã‚‹ã ã‘ã§å¯¾å¿œã§ãã¾ã™ã€‚

```typescript
// ä¾‹: ãƒ•ãƒ©ãƒ³ã‚¹èªã®ä¾‹æ–‡
const frenchExample = {
  sentence: 'Peux-tu me passer le sel?',
  // ...
};
```

### Q3: ãªãœã€Œãƒ‘ã‚¿ãƒ¼ãƒ³ç™ºè¦‹ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã€ã‚’å‰Šé™¤ã—ãŸã®ã§ã™ã‹ï¼Ÿ

**A:** äººé–“ã®è„³ã¯è‡ªå‹•çš„ã«å·®åˆ†ã‚’è¦‹ã¤ã‘ã‚‹èƒ½åŠ›ãŒã‚ã‚‹ãŸã‚ã§ã™ã€‚

- âŒ æ˜ç¤ºçš„ã«ã€Œã©ã“ãŒé•ã†ï¼Ÿã€ã¨èã â†’ ä¸è‡ªç„¶ã§æ•™è‚²çš„ã™ãã‚‹
- âœ… ä¾‹ã‚’è¦‹ã›ã¦ã€ã„ããªã‚Šãƒ†ã‚¹ãƒˆ â†’ è‡ªç„¶ãªå­¦ç¿’ãƒ—ãƒ­ã‚»ã‚¹ã«ä»»ã›ã‚‹

å­ä¾›ãŒè¨€èªã‚’ç¿’å¾—ã™ã‚‹éç¨‹ã¨åŒã˜ã‚ˆã†ã«ã€è„³ãŒå‹æ‰‹ã«ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’è¦‹ã¤ã‘ã‚‹ã®ã‚’ä¿¡é ¼ã—ã¾ã™ã€‚

### Q4: ã‚³ã‚¹ãƒˆå‰Šæ¸›ã®æ–¹æ³•ã¯ï¼Ÿ

**A:** ä»¥ä¸‹ã®æˆ¦ç•¥ã‚’æ¨å¥¨ï¼š

1. **ç”»åƒã®å†åˆ©ç”¨**: åŒã˜å ´æ‰€ãƒ»ã‚·ãƒãƒ¥ã‚¨ãƒ¼ã‚·ãƒ§ãƒ³ã®ç”»åƒã‚’ã‚­ãƒ£ãƒƒã‚·ãƒ¥
2. **é…å»¶ç”Ÿæˆ**: ã‚¢ã‚¯ã‚»ã‚¹ã•ã‚Œã‚‹ã¾ã§ç”Ÿæˆã‚’é…ã‚‰ã›ã‚‹
3. **ãƒãƒƒãƒç”Ÿæˆ**: ã¾ã¨ã‚ã¦ç”Ÿæˆã—ã¦APIã‚³ãƒ¼ãƒ«ã‚’å‰Šæ¸›
4. **ãƒ¦ãƒ¼ã‚¶ãƒ¼ç”Ÿæˆã‚³ãƒ³ãƒ†ãƒ³ãƒ„**: å°†æ¥çš„ã«ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ä¸€éƒ¨ã‚’ä½œæˆã—ã¦ã‚‚ã‚‰ã†

### Q5: ä¸­ç´šãƒ»ä¸Šç´šãƒ‘ã‚¿ãƒ¼ãƒ³ã®ä¾‹ã¯ï¼Ÿ

**ä¸­ç´šä¾‹:**

```typescript
{
  patternName: "I'm thinking about X-ing",
  description: "ã€œã—ã‚ˆã†ã‹ã¨è€ƒãˆã¦ã„ã‚‹ï¼ˆå©‰æ›²è¡¨ç¾ï¼‰",
  examples: [
    "I'm thinking about changing jobs.",
    "I'm thinking about moving to Tokyo.",
    // ...
  ]
}
```

**ä¸Šç´šä¾‹:**

```typescript
{
  patternName: "It might be worth X-ing",
  description: "ã€œã™ã‚‹ä¾¡å€¤ãŒã‚ã‚‹ã‹ã‚‚ã—ã‚Œãªã„ï¼ˆææ¡ˆï¼‰",
  examples: [
    "It might be worth trying that restaurant.",
    "It might be worth investing in that stock.",
    // ...
  ]
}
```

---

## ã¾ã¨ã‚

ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã¯ã€ãƒ‘ã‚¿ãƒ¼ãƒ³å­¦ç¿’ãƒ¢ãƒ¼ãƒ‰ã®å®Ÿè£…ã‚’å…·ä½“çš„ãªã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ™ãƒ«ã¾ã§è©³ç´°åŒ–ã—ã¾ã—ãŸã€‚

**ã‚­ãƒ¼ãƒã‚¤ãƒ³ãƒˆ:**

1. **ã‚·ãƒ³ãƒ—ãƒ«ãªå­¦ç¿’ãƒ•ãƒ­ãƒ¼**: ä¾‹æ–‡ã‚’è¦‹ã‚‹ â†’ ãƒ†ã‚¹ãƒˆï¼ˆã€‡ã€‡ã€‡å½¢å¼ï¼‰ â†’ å¿œç”¨ä¾‹ã‚’è¡¨ç¤º
2. **è„³ã®è‡ªç„¶ãªãƒ—ãƒ­ã‚»ã‚¹ã‚’ä¿¡é ¼**: ãƒ‘ã‚¿ãƒ¼ãƒ³ç™ºè¦‹ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã¯ä¸è¦ã€äººé–“ã®è„³ãŒè‡ªå‹•çš„ã«å·®åˆ†ã‚’è¦‹ã¤ã‘ã‚‹
3. **æ§‹æ–‡ç†è§£ã‚’å•ã†ãƒ†ã‚¹ãƒˆ**: ç‰¹å®šã®å˜èªã§ã¯ãªãã€Œã€‡ã€‡ã€‡ã€ã§æŠ½è±¡çš„ãªæ§‹æ–‡ç†è§£ã‚’ç¢ºèª
4. **æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ ã®æ´»ç”¨**: ç”»åƒãƒ»éŸ³å£°ç”Ÿæˆã¯æ—¢å­˜ã®problem-generatorã‚’æµç”¨
5. **Problemãƒ†ãƒ¼ãƒ–ãƒ«ã®å†åˆ©ç”¨**: PatternExampleãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œã‚‰ãšã€æ—¢å­˜Problemã«`patternId`ã‚’è¿½åŠ 
6. **ãƒ‡ãƒ¼ã‚¿ã®å¾ªç’°**: ãƒ‘ã‚¿ãƒ¼ãƒ³å­¦ç¿’ã§è¦‹ãŸå•é¡ŒãŒã€é€šå¸¸ãƒ¢ãƒ¼ãƒ‰ã§ã‚‚å¾©ç¿’ã¨ã—ã¦å‡ºç¾

**å®Ÿè£…ã®å„ªå…ˆé †ä½:**

1. **Phase 1**: Prismaã‚¹ã‚­ãƒ¼ãƒè¿½åŠ ãƒ»ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
2. **Phase 2**: ã‚·ãƒ¼ãƒ‰ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§1ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚»ãƒƒãƒˆç”Ÿæˆ
3. **Phase 3**: APIå®Ÿè£…ï¼ˆä¸€è¦§ãƒ»è©³ç´°ï¼‰
4. **Phase 4**: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å®Ÿè£…ï¼ˆä¾‹æ–‡è¡¨ç¤º â†’ ãƒ†ã‚¹ãƒˆ â†’ çµæœï¼‰
5. **Phase 5**: è¤‡æ•°ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚»ãƒƒãƒˆè¿½åŠ ãƒ»UIæ”¹å–„

**åˆè¨ˆ: ç´„2é€±é–“ã§æœ€å°é™ã®å‹•ä½œç‰ˆã‚’å®Ÿè£…å¯èƒ½**

é‡è¦ãªã®ã¯ã€ã€Œæ•™ãˆã‚‹ã€ã®ã§ã¯ãªãã€Œæ°—ã¥ã‹ã›ã‚‹ã€ä½“é¨“ã‚’ä½œã‚‹ã“ã¨ã€‚äººé–“ã®è„³ã®è‡ªç„¶ãªå­¦ç¿’ãƒ—ãƒ­ã‚»ã‚¹ã‚’ä¿¡é ¼ã—ã€ä½™è¨ˆãªæ©Ÿèƒ½ã‚’å‰Šãè½ã¨ã—ãŸã‚·ãƒ³ãƒ—ãƒ«ãªè¨­è¨ˆãŒæˆåŠŸã®éµã§ã™ã€‚

**ãƒ‡ãƒ¼ã‚¿è¨­è¨ˆã®å·¥å¤«:**

`Problem`ãƒ†ãƒ¼ãƒ–ãƒ«ã«`patternId`ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ã§ã€ãƒ‘ã‚¿ãƒ¼ãƒ³å­¦ç¿’ã§ä½¿ã£ãŸå•é¡ŒãŒé€šå¸¸ãƒ¢ãƒ¼ãƒ‰ã§ã‚‚è‡ªç„¶ã«å‡ºç¾ã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šï¼š

- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ã€Œã‚ã€ã“ã‚Œå‰ã«ãƒ‘ã‚¿ãƒ¼ãƒ³å­¦ç¿’ã§è¦‹ãŸã‚„ã¤ã ï¼ã€ã¨ã„ã†æ°—ã¥ãã‚’å¾—ã‚‰ã‚Œã‚‹
- åŒã˜æ§‹æ–‡ã‚’ç•°ãªã‚‹ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã§å¾©ç¿’ã§ãã€è¨˜æ†¶ãŒå®šç€ã—ã‚„ã™ã„
- æ–°ã—ã„ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œã‚‰ãªã„ãŸã‚ã€ã‚·ã‚¹ãƒ†ãƒ ãŒã‚·ãƒ³ãƒ—ãƒ«ã«ä¿ãŸã‚Œã‚‹

ã“ã®ã€Œå¶ç„¶ã®å¾©ç¿’ã€åŠ¹æœãŒã€é•·æœŸè¨˜æ†¶ã¸ã®å®šç€ã‚’ä¿ƒã—ã¾ã™ã€‚
